{% extends "base.html" %}

{% block content %}
<h2>Admin Dashboard</h2>

<h3>Seating Chart</h3>
<table>
  <tr>
    <th>Row \ Col</th>
    <th>1</th><th>2</th><th>3</th><th>4</th>
  </tr>
  {% for row in seating_chart %}
    <tr>
      <th>{{ row[0].row }}</th>
      {% for seat in row %}
        <td class="{{ 'reserved' if seat.reserved else 'available' }}">
          Row {{ seat.row }}, Col {{ seat.col }}<br>
          ${{ seat.price }}<br>
          {% if seat.reserved %}
            {{ seat.name }}
          {% else %}
            Free
          {% endif %}
        </td>
      {% endfor %}
    </tr>
  {% endfor %}
</table>

<h3>Total Sales</h3>
<p><strong>${{ total_sales }}</strong></p>

<h3>Reservations</h3>
{% if reservations %}
  <table>
    <tr>
      <th>ID</th>
      <th>Passenger</th>
      <th>Seat</th>
      <th>Reservation Code</th>
      <th>Created</th>
      <th>Action</th>
    </tr>
    {% for r in reservations %}
      <tr>
        <td>{{ r.id }}</td>
        <td>{{ r.passengerName }}</td>
        <td>Row {{ r.seatRow }}, Col {{ r.seatColumn }}</td>
        <td>{{ r.eTicketNumber }}</td>
        <td>{{ r.created }}</td>
        <td>
          <form method="post" action="{{ url_for('delete_reservation', reservation_id=r.id) }}">
            <button type="submit" onclick="return confirm('Delete this reservation?');">
              Delete
            </button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </table>
{% else %}
  <p>No reservations yet.</p>
{% endif %}
{% endblock %}
